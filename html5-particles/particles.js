ImagePreloader=function(){this.images=[];return this};ImagePreloader.prototype={images:null,Za:null,Aa:0,mb:function(a){var b=this,c=new Image;this.images.push(c);c.url=a;c.onload=function(){b.Aa++;b.Aa===b.images.length&&b.Za.call(b,b.images)}},Mb:function(a){this.Aa=0;this.Za=a;for(a=0;a<this.images.length;a++)this.images[a].src=this.images[a].url}};Plane=function(){this.M=new Vector;return this};
Plane.prototype={v:0,w:0,z:0,P:0,M:null,reset:function(){this.v=this.w=this.z=this.P=0},Ua:function(){this.v*=-1;this.w*=-1;this.z*=-1;this.P*=-1;return this},yb:function(a,b,c){return this.v*a+this.w*b+this.z*c>0},Ba:function(a){return this.yb(a.x,a.y,a.b)},face:function(a,b,c){if(this.v*a+this.w*b+this.z*c-this.P>0){this.v=-this.v;this.w=-this.w;this.z=-this.z;this.P=-this.P}return this},Ga:function(a){this.cb(a.h[0],a.h[1],a.h[2]);return this},cb:function(a,b,c){var d=a.k;a=Vector.prototype.Zb(a.k,
b.k,c.k).normalize();this.v=a.x;this.w=a.y;this.z=a.b;this.P=this.v*d.x+this.w*d.y+this.z*d.b;return this},Kb:function(a){this.M.m(this.v,this.w,this.z);this.M=this.M.hb(a)}};Vector=function(){this.x=this.y=this.b=0;return this};
Vector.prototype={x:0,y:0,b:0,Lb:function(a){this.x=a.x;this.y=a.y;this.b=a.b;return this},m:function(a,b,c){this.x=a;this.y=b;this.b=c;return this},normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b);if(a===0)return this;a=1/a;this.x*=a;this.y*=a;this.b*=a;return this},Ua:function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this},L:function(){var a=new Vector;a.m(this.x,this.y,this.b);return a},transform:function(a){var b=this.x*a.a[0]+this.y*a.a[1]+this.b*a.a[2]+
a.a[3],c=this.x*a.a[4]+this.y*a.a[5]+this.b*a.a[6]+a.a[7];a=this.x*a.a[8]+this.y*a.a[9]+this.b*a.a[10]+a.a[11];return(new Vector).m(b,c,a)},hb:function(a){var b=this.x*a.a[0]+this.y*a.a[1]+this.b*a.a[2],c=this.x*a.a[4]+this.y*a.a[5]+this.b*a.a[6];a=this.x*a.a[8]+this.y*a.a[9]+this.b*a.a[10];return(new Vector).m(b,c,a)},Zb:function(a,b,c){return Vector.prototype.Ka(Vector.prototype.ia(c,a),Vector.prototype.ia(b,a))},Ka:function(a,b){var c=a.x,d=a.y,e=a.b,f=b.x,h=b.y,k=b.b,l=new Vector;l.m(d*k-e*h,
e*f-c*k,c*h-f*d);return l},Yb:function(a,b){var c=new Vector;c.m(a.x+b.x,a.y+b.y,a.b+b.b);return c},ia:function(a,b){var c=new Vector;c.m(a.x-b.x,a.y-b.y,a.b-b.b);return c}};Matrix=function(){this.a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return this};
Matrix.prototype={a:null,Pb:function(a,b,c){this.wb();this.a[0]=a.x;this.a[1]=a.y;this.a[2]=a.b;this.a[4]=b.x;this.a[5]=b.y;this.a[6]=b.b;this.a[8]=c.x;this.a[9]=c.y;this.a[10]=c.b;return this},wb:function(){for(var a=0;a<4;a++)for(var b=0;b<4;b++)this.a[4*a+b]=a==b?1:0;return this},L:function(){for(var a=new Matrix,b=0;b<16;b++)a.a[b]=this.a[b];return a},Da:function(a){var b=this.L();this.a[0]=a.a[0]*b.a[0]+a.a[1]*b.a[4]+a.a[2]*b.a[8];this.a[1]=a.a[0]*b.a[1]+a.a[1]*b.a[5]+a.a[2]*b.a[9];this.a[2]=
a.a[0]*b.a[2]+a.a[1]*b.a[6]+a.a[2]*b.a[10];this.a[3]=a.a[0]*b.a[3]+a.a[1]*b.a[7]+a.a[2]*b.a[11]+a.a[3];this.a[4]=a.a[4]*b.a[0]+a.a[5]*b.a[4]+a.a[6]*b.a[8];this.a[5]=a.a[4]*b.a[1]+a.a[5]*b.a[5]+a.a[6]*b.a[9];this.a[6]=a.a[4]*b.a[2]+a.a[5]*b.a[6]+a.a[6]*b.a[10];this.a[7]=a.a[4]*b.a[3]+a.a[5]*b.a[7]+a.a[6]*b.a[11]+a.a[7];this.a[8]=a.a[8]*b.a[0]+a.a[9]*b.a[4]+a.a[10]*b.a[8];this.a[9]=a.a[8]*b.a[1]+a.a[9]*b.a[5]+a.a[10]*b.a[9];this.a[10]=a.a[8]*b.a[2]+a.a[9]*b.a[6]+a.a[10]*b.a[10];this.a[11]=a.a[8]*b.a[3]+
a.a[9]*b.a[7]+a.a[10]*b.a[11]+a.a[11]},moveTo:function(a){return this.Ya(a.x,a.y,a.b)},Ya:function(a,b,c){this.a[3]=a;this.a[7]=b;this.a[11]=c;return this},Rb:function(a){for(var b=-a.a[3],c=-a.a[7],d=-a.a[11],e=0;e<3;e++)for(var f=0;f<3;f++)this.a[e+f*4]=a.a[f+e*4];this.a[3]=b*this.a[0]+c*this.a[1]+d*this.a[2];this.a[7]=b*this.a[4]+c*this.a[5]+d*this.a[6];this.a[11]=b*this.a[8]+c*this.a[9]+d*this.a[10]},bb:function(a,b,c){var d=Math.sin(a),e=Math.sin(b),f=Math.sin(c);a=Math.cos(a);b=Math.cos(b);
c=Math.cos(c);this.a[0]=b*a;this.a[1]=-b*d;this.a[2]=e;this.a[3]=0;this.a[4]=f*e*a+d*c;this.a[5]=c*a-f*e*d;this.a[6]=-f*b;this.a[7]=0;this.a[8]=f*d-c*e*a;this.a[9]=c*e*d+f*a;this.a[10]=c*b;this.a[11]=0;this.a[12]=0;this.a[13]=0;this.a[14]=0;this.a[15]=1;return this},copy:function(a){for(var b=15;b>=0;b--)this.a[b]=a.a[b];return this}};Particle=function(){this.position=new Vector;return this};
Particle.prototype={position:null,o:0,qa:0,N:0,enabled:false,ca:0,$:0,La:1,ka:3E3,kb:4E3,Ib:0,p:0,I:0,ha:0,x:0,y:0,b:0,bc:0,type:2,ua:0,R:null,color:"#ff",l:0,n:0,D:0,eb:function(a,b,c){this.position.m(a,b,c)},Ia:function(a){this.enabled=true;switch(this.type){case 0:this.ha=140+15*Math.random();this.p=2*Math.PI*Math.random();this.I=Math.PI/3+Math.PI/16;break;case 1:this.ha=140+15*Math.random();this.p=Math.PI/8*Math.random()+this.ua;Particle.prototype.ua+=Math.PI/180;this.I=Math.PI/3+Math.PI/16;break;
case 2:this.ha=140+15*Math.random();this.p=Math.PI/4*Math.random();this.I=Math.PI/3+Math.PI/16;var b=Math.random();if(b>0.66)this.p+=120*Math.PI/180;else if(b>0.33)this.p+=240*Math.PI/180;this.p+=this.ua;break}b=this.ha*Math.cos(this.I);this.x=b*Math.cos(this.p);this.b=b*Math.sin(this.p);this.y=this.ha*Math.sin(this.I);this.Ib=Math.floor(200*Math.random());this.ca=a;this.o=0;this.qa=this.kb;this.position.m(0,0,0)},$b:function(a,b){if(this.N==this.$){if(this.o==0){this.o=a-this.ca;return true}this.position.x=
this.x*this.o/100;this.position.b=this.b*this.o/100;this.position.y=this.y*this.o/100-5*this.o*this.o/1E4;this.o=a-this.ca;if(this.o>=this.ka||this.position.y<0){this.N=this.La;this.ca=a;this.o=0;this.position.y=0}}else if(this.N==this.La){if(this.o>this.qa-this.ka){this.N=this.$;if(b)this.Ia(a);else this.enabled=false;this.o=a}this.o=a-this.ca}return false},t:function(a,b){var c=this.position.transform(b),d=c.x,e=c.y;c=a.ba/c.b;this.l=a.width/2+d*c;this.n=a.height/2-e*c;this.D=Math.abs(a.width/2+
(d+24)*c-this.l);this.l-=this.D/2;this.n-=this.D/2;a.j.beginPath();a.j.arc(this.l,this.n,this.D,0,2*Math.PI,false);a.j.fillStyle=this.color;if(this.N!=this.$){alpha=this.o/(this.qa-this.ka);if(alpha>1)alpha=1;a.j.globalAlpha=1-alpha}else a.j.globalAlpha=1;a.j.fill();a.j.globalAlpha=1},Gb:function(a,b){if(this.N==this.$){var c=(new Vector).Lb(this.position);c.y=-c.y;c=c.transform(b);var d=c.x,e=c.y;c=a.ba/c.b;this.l=a.width/2+d*c;this.n=a.height/2-e*c;this.D=Math.abs(a.width/2+(d+24)*c-this.l);this.l-=
this.D/2;this.n-=this.D/2;a.j.beginPath();a.j.arc(this.l,this.n,this.D,0,2*Math.PI,false);a.j.fillStyle=this.color;if(this.N!=this.$){alpha=this.o/(this.qa-this.ka);if(alpha>1)alpha=1;a.j.globalAlpha=1-alpha}else a.j.globalAlpha=1;a.j.globalAlpha*=0.5;a.j.fill();a.j.globalAlpha=1}}};ParticleSystem=function(){this.za=["#00ff00","#00ff7f","#007fff","#007f3f","#007f3f"];return this};
ParticleSystem.prototype={s:null,Ab:0,Ea:null,q:0,S:0,tb:5E3,enabled:false,Db:true,p:0,O:null,za:null,xb:function(a,b,c,d){this.s=[];for(var e=0;e<a;e++){var f=new Particle;f.bc=Math.random();f.Ia(c.currentTime);if(null!=d)f.R=d[Math.floor(Math.random()*(d.length-0.01))];this.s.push(f)}this.db(this.za);this.Ab=a;this.Ea=new Matrix;this.S=b;return this},db:function(a){this.za=a;for(var b=0;b<this.s.length;b++)this.s[b].color=a[Math.floor(Math.random()*(a.length-0.01))]},Ob:function(a){this.tb=a;return this},
Xb:function(a,b){for(var c=0;c<this.q;c++)this.s[c].enabled&&this.s[c].Gb(a,b)},ga:function(a,b){if(!this.enabled)return this;this.Ea.bb(0,this.p,0);this.O=this.Ea.L();this.O.a[3]-=b.r.V.x;this.O.a[7]-=b.r.V.y;this.O.a[11]-=b.r.V.b;this.O.Da(b.r.u);if(this.q<this.S)this.q<this.S&&this.s[this.q++].Ia(b.currentTime);else if(this.q>this.S)for(;this.q>this.S;){if(this.q<this.s.length&&this.q>=0)this.s[this.q].enabled=false;this.q--}return this},t:function(a){for(var b=0,c=0;c<this.q;c++)if(this.s[c].enabled){this.s[c].t(a,
this.O);this.s[c].$b(a.currentTime,this.Db);b++}if(this.q>0&&b==0)this.enabled=false}};Scene=function(){this.Sa=90;this.r=new Camera;this.r.ra((new Vector).m(0,0,-700),(new Vector).m(0,0,0));this.fa=[];this.U=new RenderPipeline;return this};
Scene.prototype={width:0,height:0,ba:0,Sa:90,j:null,r:null,currentTime:0,fa:null,la:0,U:null,pa:0,ea:0,Qa:0,ac:0,Ta:0,background:"#ffffff",Wa:null,Va:null,Ub:function(a,b){this.width=a;this.height=b;this.ba=a/Math.tan(this.Sa/2);this.Wa=(new Vector).m(-1,0,0);return this},Vb:function(a){this.j=a;return this},na:function(){return this.width},ma:function(){return this.height},sb:function(){this.pa++;this.da=(new Date).getTime();if(this.da-this.ea>=500){if(this.da-this.ea<2E3)this.ac+=this.da-this.ea;
this.Qa=this.pa/((this.da-this.ea)/1E3);this.pa=0;this.ea=this.da}var a=Math.floor(this.Qa*100);if(this.pa==0)this.Ta=a/100},t:function(){this.j.save();this.j.fillStyle=this.background;this.j.fillRect(0,0,this.width,this.height);this.U.reset();this.Va=this.Wa.L().normalize();for(var a=0;a<this.fa.length;a++)this.fa[a].ga(this.la,this,this.r);this.U.t(this);this.sb();this.j.strokeStyle="#0";this.j.strokeText("Fps: "+this.Ta,10,30);this.j.strokeText("Faces: "+(this.U.ja.i.length+this.U.T.i.length),
10,20);this.j.restore();this.la++},nb:function(a){this.fa.push(a)}};Camera=function(){this.u=new Matrix;this.V=new Vector;this.Xa=new Vector;this.forward=new Vector;return this};
Camera.prototype={u:null,V:null,Xa:null,forward:null,ib:0,p:0,I:0,ba:0,ra:function(a,b){this.V=a.L();this.Xa=b.L();this.forward=Vector.prototype.ia(a,b);var c=(new Vector).m(0,-1,0),d=Vector.prototype.Ka(c,this.forward);c=Vector.prototype.Ka(this.forward,d);this.forward.normalize();c.normalize();d.normalize();this.u=(new Matrix).Pb(d,c,this.forward)}};Vertex=function(){this.k=new Vector;this.W=new Vector;this.Bb=new Vector;this.Jb=new Vector;this.Oa=[];return this};
Vertex.prototype={k:null,Bb:null,W:null,Jb:null,l:0,n:0,Oa:null,$a:-1,ta:function(a){this.Oa.push(a);return this},Fa:function(a,b,c){if(a==this.$a)return this;this.W=this.k.transform(c);this.$a=a;b/=this.W.b;this.l=this.W.x*b+g.width/2;this.n=-this.W.y*b+g.height/2;return this}};Model=function(){this.position=new Vector;this.aa=new Vector;this.h=[];this.i=[];this.B=new Matrix;this.u=new Matrix;this.Ca=new Matrix;this.zb=true;return this};
Model.prototype={position:null,aa:null,h:null,i:null,B:null,u:null,Ca:null,zb:false,p:0,I:0,ib:0,rb:0,G:0,X:0,H:0,Y:0,J:0,Z:0,oa:null,va:null,vb:1,jb:2,qb:function(a){this.h.push(a);return this},ga:function(a,b,c){this.B.bb(this.ib,this.p,this.I);this.aa=this.position.L();if(this.oa!=null){this.aa=Vector.prototype.Yb(this.oa.aa,this.position.hb(this.oa.B));if(this.vb==this.jb){this.B.Da(this.oa.B);this.B.Ya(0,0,0)}}var d=Vector.prototype.ia(this.aa,c.V);this.Ca.Rb(this.B);var e=d.transform(this.Ca);
this.u.copy(this.B);this.u.moveTo(d.Ua());this.u.Da(c.u);d=b.Va;for(var f=this.i.length-1;f>=0;f--)if(this.i[f].ub(e))if(this.i[f].Fa(a,b.ba,this.u)){this.i[f].Q=-(this.i[f].C.M.x*d.x+this.i[f].C.M.y*d.y+this.i[f].C.M.b*d.b);b.U.ob(this.i[f])}if(null!=this.va)for(f=0;f<this.va.length;f++)this.va[f].ga(a,b,c)},create:function(a,b){for(var c=0;c<a.length;c++){var d=new Vertex;d.k.m(a[c].x,a[c].y,a[c].b);this.qb(d)}for(c=0;c<b.length;c++)this.i.push((new Polygon).Wb(this.h[b[c].c],this.h[b[c].d],this.h[b[c].e]));
this.Cb();return this},Ra:function(){var a,b,c,d,e,f;f=e=d=c=b=a=0;for(var h=this.h.length-1;h>=0;h--){var k=this.h[h].k;if(k.x<this.h[a].k.x)a=h;if(k.x>this.h[b].k.x)b=h;if(k.y<this.h[c].k.y)c=h;if(k.y>this.h[d].k.y)d=h;if(k.b<this.h[e].k.b)e=h;if(k.b>this.h[f].k.b)f=h}this.G=this.h[a].k.x;this.X=this.h[b].k.x;this.H=this.h[c].k.y;this.Y=this.h[d].k.y;this.J=this.h[e].k.b;this.Z=this.h[f].k.b;a=0;if(Math.abs(this.G)>a)a=Math.abs(this.G);if(Math.abs(this.H)>a)a=Math.abs(this.H);if(Math.abs(this.J)>
a)a=Math.abs(this.J);if(Math.abs(this.X)>a)a=Math.abs(this.X);if(Math.abs(this.Y)>a)a=Math.abs(this.Y);if(Math.abs(this.Z)>a)a=Math.abs(this.Z);this.rb=a},Cb:function(){this.Ra();var a;for(a=this.h.length-1;a>=0;a--){this.h[a].k.x=this.h[a].k.x-this.G-(this.X-this.G)/2;this.h[a].k.y=this.h[a].k.y-this.H-(this.Y-this.H)/2;this.h[a].k.b=this.h[a].k.b-this.J-(this.Z-this.J)/2}for(a=0;a<this.i.length;a++)this.i[a].Ga();this.eb(this.position.x-this.G-(this.X-this.G)/2,this.position.y-this.H-(this.Y-this.H)/
2,this.position.b-this.J-(this.Z-this.J)/2)},eb:function(a,b,c){this.position.m(a,b,c)},Ha:function(a,b,c,d,e){for(var f=0;f<this.i.length;f++)this.i[f].Ha(a,b,c,d,e)}};Polygon=function(){this.h=[];this.C=new Plane;this.A=[0,0,0,0,0,0,0,0];this.style=0;return this};
Polygon.prototype={h:null,C:null,Q:0,K:0,F:null,A:null,ya:255,xa:0,wa:127,Pa:255,style:0,lb:1,Ma:0,Na:2,sa:4,Wb:function(a,b,c){this.h.push(a);this.h.push(b);this.h.push(c);a.ta(this);b.ta(this);c.ta(this);this.Ga();return this},face:function(a,b,c){this.C.face(a,b,c);return this},Ba:function(a){return this.C.Ba(a)},ub:function(a){return this.Ba(Vector.prototype.ia(this.h[0].k,a))},Ga:function(){this.C.cb(this.h[0],this.h[1],this.h[2]);return this},Nb:function(){for(var a=0,b=this.h.length-1;b>=0;b--)a+=
this.h[b].W.b;a/=this.h.length;this.K=a},Fa:function(a,b,c){for(var d=true,e=this.h.length-1;e>=0;e--){this.h[e].Fa(a,b,c);if(this.h[e].cc<0.5)d=false}this.C.Kb(c);this.Nb();return d},t:function(a){switch(this.style){case this.Na:this.Hb(a);break;case this.Ma:case this.sa:this.Eb(a);break;case this.lb:default:this.Fb(a)}},Fb:function(a){var b=this.h[0].l,c=this.h[0].n,d=this.h[1].l,e=this.h[1].n,f=this.h[2].l,h=this.h[2].n;a.beginPath();a.moveTo(b,c);a.lineTo(d,e);a.lineTo(f,h);a.lineTo(b,c);a.strokeStyle=
"#0";a.stroke()},Eb:function(a){a.beginPath();a.moveTo(this.h[0].l,this.h[0].n);a.lineTo(this.h[1].l,this.h[1].n);a.lineTo(this.h[2].l,this.h[2].n);a.closePath();if(this.Q<0)this.Q=0;var b=Math.floor(this.Q*this.ya),c=Math.floor(this.Q*this.xa),d=Math.floor(this.Q*this.wa),e=this.color;if(this.style==this.sa)e="rgba("+this.ya+","+this.xa+","+this.wa+",255)";else if(this.style==this.Ma)e="rgba("+b+","+c+","+d+","+this.Pa+")";a.fillStyle=e;a.fill();a.strokeStyle=e;a.stroke()},Hb:function(a){var b=this.h[0].l,
c=this.h[0].n,d=this.h[1].l,e=this.h[1].n,f=this.h[2].l,h=this.h[2].n;a.save();a.beginPath();a.moveTo(b,c);a.lineTo(d,e);a.lineTo(f,h);a.lineTo(b,c);a.clip();a.stroke();var k=this.A[0]*this.F.na(),l=this.A[1]*this.F.ma(),i=this.A[2]*this.F.na(),j=this.A[3]*this.F.ma(),n=this.A[4]*this.F.na(),o=this.A[5]*this.F.ma(),t=k*(o-j)-i*o+n*j+(i-n)*l;if(t!=0){a.setTransform(-(l*(f-d)-j*f+o*d+(j-o)*b)/t,(j*h+l*(e-h)-o*e+(o-j)*c)/t,(k*(f-d)-i*f+n*d+(i-n)*b)/t,-(i*h+k*(e-h)-n*e+(n-i)*c)/t,(k*(o*d-j*f)+l*(i*f-
n*d)+(n*j-i*o)*b)/t,(k*(o*e-j*h)+l*(i*h-n*e)+(n*j-i*o)*c)/t);a.drawImage(this.F.R,0,0)}a.restore()},Ha:function(a,b,c,d,e){this.ya=a;this.xa=b;this.wa=c;this.Pa=d;this.style=e}};RenderPipeline=function(){this.T=new PolygonStack;this.ja=new PolygonStack;return this};RenderPipeline.prototype={T:[],ja:[],ab:null,ob:function(a){this.T.pb(a)},reset:function(){this.T.reset();this.ja.reset()},t:function(a){this.T.fb();this.T.t(a.j,this.ab);this.ja.fb();this.ja.t(a.j,this.ab)}};
PolygonStack=function(){this.i=[];return this};
PolygonStack.prototype={i:null,pb:function(a){this.i.push(a)},reset:function(){this.i=[]},fb:function(){this.i.length!=0&&this.Ja(0,this.i.length-1)},gb:function(a,b){var c,d,e;c=a;d=b;e=this.i[a+b>>1].K;do{for(;this.i[c].K>e;)++c;for(;e>this.i[d].K;)--d;if(c<=d){var f=this.i[c];this.i[c]=this.i[d];this.i[d]=f;++c;--d}}while(c<=d);a<d&&this.gb(a,d);c<b&&this.gb(c,b)},Ja:function(a,b){var c,d,e;c=a;d=b;e=this.i[a+b>>1].K;do{for(;this.i[c].K<e;)++c;for(;e<this.i[d].K;)--d;if(c<=d){var f=this.i[c];this.i[c]=
this.i[d];this.i[d]=f;++c;--d}}while(c<=d);a<d&&this.Ja(a,d);c<b&&this.Ja(c,b)},t:function(a){for(var b=this.i.length-1;b>=0;b--)this.i[b].t(a)}};Texture=function(){return this};Texture.prototype={R:null,Qb:function(a){this.R=a;return this},na:function(){return this.R.width-1},ma:function(){return this.R.height-1}};Texturizer=function(){return this};
Texturizer.prototype={Sb:function(a,b,c){a.Ra();for(var d=0;d<a.i.length;d++){this.Tb(a.i[d],c,a.G,a.X,a.H,a.Y,a.J,a.Z,b);a.i[d].F=b;a.i[d].style=Polygon.prototype.Na}},Tb:function(a,b,c,d,e,f,h,k){for(var l,i,j=0;j<a.h.length;j++){switch(b){case 0:l=(d-a.h[j].k.x)/(d-c);i=(f-a.h[j].k.y)/(f-e);break;case 1:l=a.h[j].k.x;i=a.h[j].k.b;l=(d-l)/(d-c);i=(k-i)/(k-h);break;case 2:l=(k-a.h[j].k.b)/(k-h);i=(f-a.h[j].k.y)/(f-e);break}if(l<0)l=0;if(i<0)i=0;if(l>1)l=1;if(i>=1)i=1;a.A[j*2]=l;a.A[j*2+1]=i}}};var m=true,q=true,r=null,s=null,u=15E3,v=0,w=null,x=null,g=null,y=null,z=3500,D=null,E=null,F=false,G=-1,H=-1,I=0,J=Math.PI/32;
function K(){var a=(new Date).getTime();g.j.save();if(m){var b=z+1300*Math.sin(g.currentTime*6.0E-4);g.r.ra((new Vector).m(-b*Math.cos(g.currentTime*3.0E-4),1E3+500*Math.cos(g.currentTime*4.0E-4),-b*Math.sin(g.currentTime*3.0E-4)),(new Vector).m(250*Math.sin(g.currentTime*2.0E-4),250+250*Math.sin(g.currentTime*2.0E-4),250*Math.cos(g.currentTime*2.0E-4)))}else g.r.ra((new Vector).m(3500*Math.cos(J)*Math.cos(I),1500*Math.sin(J),3500*Math.cos(J)*Math.sin(I)),(new Vector).m(0,0,0));g.t();g.j.globalAlpha=
1;y.ga(g.la,g,g.r);g.j.restore();r.ga(g.la,g,g.r);g.j.save();g.j.beginPath();g.j.moveTo(r.h[0].l,r.h[0].n);g.j.lineTo(r.h[1].l,r.h[1].n);g.j.lineTo(r.h[3].l,r.h[3].n);g.j.lineTo(r.h[2].l,r.h[2].n);g.j.closePath();g.j.clip();y.Xb(g,y.O);g.j.restore();y.t(g);if(Math.floor(g.currentTime/u)!=v){Particle.prototype.type++;if(Particle.prototype.type>2)Particle.prototype.type=0;v++}g.currentTime+=a-D;D=a}
function L(a){ctx=x.getContext("2d");g=(new Scene).Ub(600,400).Vb(ctx);g.r.ra((new Vector).m(0,700,-3500),(new Vector).m(0,0,0));s=(new Model).create([{x:-1500,y:0,b:-1500,f:0,g:0},{x:-1125,y:0,b:-1500,f:0,g:0},{x:-750,y:0,b:-1500,f:0,g:0},{x:-375,y:0,b:-1500,f:0,g:0},{x:0,y:0,b:-1500,f:0,g:0},{x:375,y:0,b:-1500,f:0,g:0},{x:750,y:0,b:-1500,f:0,g:0},{x:1125,y:0,b:-1500,f:0,g:0},{x:1500,y:0,b:-1500,f:0,g:0},{x:-1500,y:0,b:-1125,f:0,g:0},{x:-1125,y:0,b:-1125,f:0,g:0},{x:-750,y:0,b:-1125,f:0,g:0},{x:-375,
y:0,b:-1125,f:0,g:0},{x:0,y:0,b:-1125,f:0,g:0},{x:375,y:0,b:-1125,f:0,g:0},{x:750,y:0,b:-1125,f:0,g:0},{x:1125,y:0,b:-1125,f:0,g:0},{x:1500,y:0,b:-1125,f:0,g:0},{x:-1500,y:0,b:-750,f:0,g:0},{x:-1125,y:0,b:-750,f:0,g:0},{x:-750,y:0,b:-750,f:0,g:0},{x:-375,y:0,b:-750,f:0,g:0},{x:0,y:0,b:-750,f:0,g:0},{x:375,y:0,b:-750,f:0,g:0},{x:750,y:0,b:-750,f:0,g:0},{x:1125,y:0,b:-750,f:0,g:0},{x:1500,y:0,b:-750,f:0,g:0},{x:-1500,y:0,b:-375,f:0,g:0},{x:-1125,y:0,b:-375,f:0,g:0},{x:-750,y:0,b:-375,f:0,g:0},{x:-375,
y:0,b:-375,f:0,g:0},{x:0,y:0,b:-375,f:0,g:0},{x:375,y:0,b:-375,f:0,g:0},{x:750,y:0,b:-375,f:0,g:0},{x:1125,y:0,b:-375,f:0,g:0},{x:1500,y:0,b:-375,f:0,g:0},{x:-1500,y:0,b:0,f:0,g:0},{x:-1125,y:0,b:0,f:0,g:0},{x:-750,y:0,b:0,f:0,g:0},{x:-375,y:0,b:0,f:0,g:0},{x:0,y:0,b:0,f:0,g:0},{x:375,y:0,b:0,f:0,g:0},{x:750,y:0,b:0,f:0,g:0},{x:1125,y:0,b:0,f:0,g:0},{x:1500,y:0,b:0,f:0,g:0},{x:-1500,y:0,b:375,f:0,g:0},{x:-1125,y:0,b:375,f:0,g:0},{x:-750,y:0,b:375,f:0,g:0},{x:-375,y:0,b:375,f:0,g:0},{x:0,y:0,b:375,
f:0,g:0},{x:375,y:0,b:375,f:0,g:0},{x:750,y:0,b:375,f:0,g:0},{x:1125,y:0,b:375,f:0,g:0},{x:1500,y:0,b:375,f:0,g:0},{x:-1500,y:0,b:750,f:0,g:0},{x:-1125,y:0,b:750,f:0,g:0},{x:-750,y:0,b:750,f:0,g:0},{x:-375,y:0,b:750,f:0,g:0},{x:0,y:0,b:750,f:0,g:0},{x:375,y:0,b:750,f:0,g:0},{x:750,y:0,b:750,f:0,g:0},{x:1125,y:0,b:750,f:0,g:0},{x:1500,y:0,b:750,f:0,g:0},{x:-1500,y:0,b:1125,f:0,g:0},{x:-1125,y:0,b:1125,f:0,g:0},{x:-750,y:0,b:1125,f:0,g:0},{x:-375,y:0,b:1125,f:0,g:0},{x:0,y:0,b:1125,f:0,g:0},{x:375,
y:0,b:1125,f:0,g:0},{x:750,y:0,b:1125,f:0,g:0},{x:1125,y:0,b:1125,f:0,g:0},{x:1500,y:0,b:1125,f:0,g:0},{x:-1500,y:0,b:1500,f:0,g:0},{x:-1125,y:0,b:1500,f:0,g:0},{x:-750,y:0,b:1500,f:0,g:0},{x:-375,y:0,b:1500,f:0,g:0},{x:0,y:0,b:1500,f:0,g:0},{x:375,y:0,b:1500,f:0,g:0},{x:750,y:0,b:1500,f:0,g:0},{x:1125,y:0,b:1500,f:0,g:0},{x:1500,y:0,b:1500,f:0,g:0}],[{c:1,d:10,e:9},{c:1,d:9,e:0},{c:2,d:11,e:10},{c:2,d:10,e:1},{c:3,d:12,e:11},{c:3,d:11,e:2},{c:4,d:13,e:12},{c:4,d:12,e:3},{c:5,d:14,e:13},{c:5,d:13,
e:4},{c:6,d:15,e:14},{c:6,d:14,e:5},{c:7,d:16,e:15},{c:7,d:15,e:6},{c:8,d:17,e:16},{c:8,d:16,e:7},{c:10,d:19,e:18},{c:10,d:18,e:9},{c:11,d:20,e:19},{c:11,d:19,e:10},{c:12,d:21,e:20},{c:12,d:20,e:11},{c:13,d:22,e:21},{c:13,d:21,e:12},{c:14,d:23,e:22},{c:14,d:22,e:13},{c:15,d:24,e:23},{c:15,d:23,e:14},{c:16,d:25,e:24},{c:16,d:24,e:15},{c:17,d:26,e:25},{c:17,d:25,e:16},{c:19,d:28,e:27},{c:19,d:27,e:18},{c:20,d:29,e:28},{c:20,d:28,e:19},{c:21,d:30,e:29},{c:21,d:29,e:20},{c:22,d:31,e:30},{c:22,d:30,e:21},
{c:23,d:32,e:31},{c:23,d:31,e:22},{c:24,d:33,e:32},{c:24,d:32,e:23},{c:25,d:34,e:33},{c:25,d:33,e:24},{c:26,d:35,e:34},{c:26,d:34,e:25},{c:28,d:37,e:36},{c:28,d:36,e:27},{c:29,d:38,e:37},{c:29,d:37,e:28},{c:30,d:39,e:38},{c:30,d:38,e:29},{c:31,d:40,e:39},{c:31,d:39,e:30},{c:32,d:41,e:40},{c:32,d:40,e:31},{c:33,d:42,e:41},{c:33,d:41,e:32},{c:34,d:43,e:42},{c:34,d:42,e:33},{c:35,d:44,e:43},{c:35,d:43,e:34},{c:37,d:46,e:45},{c:37,d:45,e:36},{c:38,d:47,e:46},{c:38,d:46,e:37},{c:39,d:48,e:47},{c:39,d:47,
e:38},{c:40,d:49,e:48},{c:40,d:48,e:39},{c:41,d:50,e:49},{c:41,d:49,e:40},{c:42,d:51,e:50},{c:42,d:50,e:41},{c:43,d:52,e:51},{c:43,d:51,e:42},{c:44,d:53,e:52},{c:44,d:52,e:43},{c:46,d:55,e:54},{c:46,d:54,e:45},{c:47,d:56,e:55},{c:47,d:55,e:46},{c:48,d:57,e:56},{c:48,d:56,e:47},{c:49,d:58,e:57},{c:49,d:57,e:48},{c:50,d:59,e:58},{c:50,d:58,e:49},{c:51,d:60,e:59},{c:51,d:59,e:50},{c:52,d:61,e:60},{c:52,d:60,e:51},{c:53,d:62,e:61},{c:53,d:61,e:52},{c:55,d:64,e:63},{c:55,d:63,e:54},{c:56,d:65,e:64},{c:56,
d:64,e:55},{c:57,d:66,e:65},{c:57,d:65,e:56},{c:58,d:67,e:66},{c:58,d:66,e:57},{c:59,d:68,e:67},{c:59,d:67,e:58},{c:60,d:69,e:68},{c:60,d:68,e:59},{c:61,d:70,e:69},{c:61,d:69,e:60},{c:62,d:71,e:70},{c:62,d:70,e:61},{c:64,d:73,e:72},{c:64,d:72,e:63},{c:65,d:74,e:73},{c:65,d:73,e:64},{c:66,d:75,e:74},{c:66,d:74,e:65},{c:67,d:76,e:75},{c:67,d:75,e:66},{c:68,d:77,e:76},{c:68,d:76,e:67},{c:69,d:78,e:77},{c:69,d:77,e:68},{c:70,d:79,e:78},{c:70,d:78,e:69},{c:71,d:80,e:79},{c:71,d:79,e:70}]);r=(new Model).create([{x:-1500,
y:0,b:-1500,f:0,g:0},{x:1500,y:0,b:-1500,f:0,g:0},{x:-1500,y:0,b:1500,f:0,g:0},{x:1500,y:0,b:1500,f:0,g:0}],[{c:1,d:3,e:2},{c:1,d:2,e:0}]);r.Ha(32,128,255,255,Polygon.prototype.sa);(new Texturizer).Sb(s,(new Texture).Qb(a[0]),1);g.nb(s);y=(new ParticleSystem).xb(750,250,this,a);y.Ob(5500);y.enabled=true;M()}function M(){q=!q;g.fa[0]=q?s:r}
function N(a){document.getElementById("textured").addEventListener("change",function(){M()},false);document.getElementById("maxParticles").addEventListener("change",function(){y.S=parseInt(document.getElementById("maxParticles").value)},false);document.getElementById("pcs").addEventListener("change",function(){y.db(E[parseInt(document.getElementById("pcs").value)])},false);document.getElementById("ct").addEventListener("change",function(){m=!m},false);E=[];E.push(["#00ff00","#00ff7f","#007fff","#007f3f",
"#007f3f"]);E.push(["#ff0000","#ff7f00","#ff007f","#7f3f00","#7f003f"]);E.push(["#ff0000","#00ff00","#0000ff"]);x=document.getElementById("screen");x.onmouseover=function(b){if(!b)b=window.event;G=b.x;H=b.y};x.onmouseout=function(){H=G=-1};x.onmousedown=function(){F=true};x.onmouseup=function(){F=false};x.onmousemove=function(b){if(!b)b=window.event;I=(b.x-G)/1E3*2*Math.PI;J=Math.abs(b.y-H)/100*(Math.PI-Math.PI/16)/2+Math.PI/16;if(J<Math.PI/16)J=Math.PI/16;else if(J>Math.PI-Math.PI/16)J=Math.PI-Math.PI/
16};x.width=600;x.height=400;L(a);D=(new Date).getTime();w=setInterval(K,30)}window.addEventListener("load",function(){var a=new ImagePreloader;a.mb("http://labs.hyperandroid.com/wp-content/uploads/2010/08/marble3.gif");a.Mb(N)},false);
